<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript">
        if (location.href.endsWith("index.html")) {
            location.href = location.href.substring(0, location.href.length - "index.html".length);
        }
    </script>
    
    <title>C++20：从一个 Proposal 列表说起</title>
    

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/styles/default.min.css"
        media="(prefers-color-scheme: light)">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/styles/dracula.min.css"
        media="(prefers-color-scheme: dark)">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/styles/default.min.css"
        media="(prefers-color-scheme: no-preference)">
    <style type="text/css">
        body {
            width: 60%;
            margin: 0 auto;
            padding: 2em;
            font-family: 'Segoe UI',
                "Microsoft Yahei Light",
                "San Francisco",
                "Ping Fang SC",
                "Roboto",
                "Noto Sans CJK",
                Tahoma, Geneva, Verdana, sans-serif;
        }

        span.field {
            display: inline-block;
            font-weight: bolder;
            font-size: smaller;
        }

        pre {
            max-width: 90%;
            overflow-x: scroll;
            padding: 1em;
            border-radius: 5px;
        }

        a {
            text-decoration: none;
            color: cornflowerblue;
        }

        a:visited {
            color: cornflowerblue;
        }

        a:hover {
            color: darkgray;
        }

        a.disabled-link {
            color: lightcoral;
            text-decoration: line-through;
        }

        nav,
        nav ul {
            display: inline-block;
        }

        .tags ul,
        footer ul {
            padding: 0;
            display: inline;
        }

        header h1 {
            display: inline-block;
            min-width: 320px;
            max-width: 50%;
            width: 50%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            margin: auto;
        }

        @media screen and (max-width: 1200px) {
            body {
                width: 90%;
                max-width: 720px;
                padding: 0;
                margin: 1em auto;
            }

            header h1 {
                max-width: 90%;
                width: 90%;
            }
        }

        nav li,
        .tags li,
        footer li {
            display: inline;
            border-right: 1px solid darkgray;
            padding: 0 1em;
        }

        nav li:last-child,
        .tags li:last-child,
        footer li:last-child {
            border: none;
        }

        .post-list h3 {
            margin: 0.3em 0;
        }

        blockquote {
            margin: 0.5em;
            border: 1px dotted darkgrey;
            border-radius: 0.5em;
            padding: 0 1em;
        }

        @media (prefers-color-scheme: dark) {
            body {
                background-color: #090810;
                color: floralwhite;
                opacity: 0.83;
            }

            pre {
                background-color: #282a36;
            }
        }
    </style>
</head>

<body>

    <header>
        
        <h1 title="C++20：从一个 Proposal 列表说起">C++20：从一个 Proposal 列表说起</h1>
        
        <nav>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/articles">Articles</a></li>
                <li><a href="/about">About</a></li>
            </ul>
        </nav>
        <hr>
        <span class="field">Author: <a href="/about">KimmyLeo</a></span>
        
    </header>
    <article>
        <blockquote>
<p>连续鸽了 4 个月。一方面是因为没有大纲，并且需要准备特别多的辅助信息，导致这个系列非常难准备；另外一个原因就是 6 月份的时候 BS 的论文终于出来了，一直在苦读看能不能从他老人家那里拿点什么。</p>
<p>在交叉参考了 BS 的几篇论文以后，大致上才有一个大致的内容框架。</p>
<p>这是本系列的第二篇，我们还是得回头看，C++20 之前，到底是什么样子的。</p>
</blockquote>
<p>上一次 HOPL 已经是 2006 年的事情了，如同前文所说，BS 也参与了这场会议，总结了一下 C++98 和即将到来的 C++0x，并且在那场会议上，给大家画了一个大饼。</p>
<p>这个大饼是怎么来的呢，？知道 2006 年的时候，已经有人开始讨论要不要放弃 C++ 了（<a href="https://www.zhihu.com/answer/239870475" title="放弃C++"><del>最近几年以刘雨培为代表的东半球 C++ 专家们也讨论过类似的话题</del></a>）。</p>
<p>原因是，作为一门传统的编程语言，C++在很多方面力有不逮，大部分应用平台已经不再采用 C++ 作为主力的编程语言，而是跟其他编程语言一样，共同享有标准的应用编程接口。微软有 C#、苹果有 Objective-C，甚至就算是用了 C++，两家都还混合了自己的私货，造了 C++/CLI 和 Objective-C++。</p>
<p>另外的原因也有，比如 <strong>ABI 不稳定</strong>，以及像 Java 等应用编程语言<strong>针对性的宣传</strong>，和大学的<strong>误导性教育</strong>等，都使得 C++ 逐渐成为那个被人嫌弃的对象。</p>
<blockquote>
<p>一些误导性的观点集中于 Java 的自动内存管理（垃圾回收）机制，把 C++ 宣传成一个手动管理资源的编程语言，故意撇开 RAII 这点不谈。但像 Java 这种最后还是加入了 try-with-resources 这种类似的机制。</p>
</blockquote>
<p>已经到了突破和发力的时候了。</p>
<p>在 2006 年 HOPL 3 的 paper 里，BS 给了一个长达 39 项列表，这些都是后来要加到 C++0x（原计划 07）的。</p>
<p>然后从 07 变成了 08、09，逐渐变成了 1x，到 2011 年才发布 C++11。在这个 39 项的列表里面，只有 24 项成功地进入到了 2011，剩下的那些，直到 C++20 才勉强加进去了几个。</p>
<p>所以从那以来的很长一段时间，整个 C++ 标准委员会就是在围绕着<strong>实现这个列表画的饼</strong>和<strong>给标准打补丁</strong>这两件事儿转。当然也有些不嫌事儿多的人在继续画饼。</p>
<p>列表详细内容如下：</p>
<blockquote>
<ol>
<li><code>decltype</code> &amp; <code>auto</code> type deduction from expressions</li>
<li>Template alias</li>
<li>Extern template</li>
<li>Move semantics</li>
<li>Static assertion</li>
<li><code>long long</code> &amp; other C99 features</li>
<li><code>&gt;&gt;</code> without space to terminate 2 template specializations</li>
<li>Unicode data type</li>
<li>Variadic templates</li>
<li>Concepts</li>
<li>Generalized constant expression</li>
<li>Initializer lists as expressions</li>
<li>Scoped and strongly typed enumerations</li>
<li>Control of alignment</li>
<li><code>nullptr</code></li>
<li>Range based <code>for</code> statement</li>
<li>Deletating constructors</li>
<li>Inherited constructors</li>
<li>Atomic operations</li>
<li>Thread-local storage</li>
<li>Defaulting and inhibiting common operations</li>
<li>Lambda functions</li>
<li>Programmer-controlled garbage collection</li>
<li>In-class member intializers</li>
<li>Allow local classes as template parameters</li>
<li>Modules</li>
<li>Dynamic library support</li>
<li>Integer sub-ranges</li>
<li>Multi-methods</li>
<li>Class namespaces</li>
<li>Continuations</li>
<li>Contract programming</li>
<li>User-defined <code>operator dot</code></li>
<li><code>switch</code> on <code>string</code></li>
<li>Simple compile-time reflection</li>
<li><code>#nomacro</code></li>
<li>GUI support (e.g. slot &amp; signals)</li>
<li>Relfection</li>
<li>Concurrency primitives in the language (not in a library)</li>
</ol>
</blockquote>
<p>可以看到，C++20 的三个大特性（Concept、Module、Coroutine），有两个是在里面的。而 Coroutine 也可以看成某种简化了之后的 Continuation（第 31 项）。其余的特性和改进，多多少少也都与前 25 项（除了第 10 项 concept 以外都已经合并进了 C++11）有关。</p>
<hr>
<p>其实十几年来 C++ 的进步也算比较快，虽然并没有按照 BS 的希望一步达成所有的结果，但在明显处于弱势的情况下保持领先，还是非常好的。</p>
<p>对比一些现代编程语言来说，C++ 这种由标准委员会控制语言特性，由特定的供应商开发实现的情况，某种程度上会影响编程语言的演进效率。像 Golang、Rust、Swift 等，其新特性设计和开发都对应的同一个实际控制者，所以表现的能更现代一些。当然问题也同样有：要么没有标注委员会这种综合照顾每一方的角色，会过度随意；要么没有精细考虑特性设计、过度主观，会逐步暴露问题难以进展；要么就形成一个极度偏执目无一切的社区。</p>
<p>纵观整个 C++0x 到 C++20 的演进过程，Concepts 是贯穿其中的非常重要的一条线。在 2009 年甚至已经合并进了标准文本中，最后又不得不删除改进成了 Concepts TS，然后在 C++20 再度合并进标准。我们接下来要聊，自然就是这部分内容。</p>
<p>（待续）</p>

        

    </article>
    <!-- <div>
        <h5>See Also</h5>
        <ul>
            <li><a href="/about">About Me</a></li>
        </ul>
    </div> -->
    <span class="field">创建时间：2020-08-02</span>
    <span class="field">最近更新时间：2020-09-12</span>
    <hr>
    <footer>
        <ul>
            <li><a href="/about">关于我</a></li>
            <li><a href="/sitemap.xml">站点地图</a></li>
            <li><a href="/rss.xml">RSS</a></li>
            <li>Copyright &copy; KimmyLeo</li>
        </ul>
    </footer>
    <script type="text/javascript">
        document.querySelectorAll(".disabled-link").forEach(el => el.addEventListener("click", (e) => {
            alert("链接页面不存在！");
            e.preventDefault();
        }))
    </script>
</body>

</html>